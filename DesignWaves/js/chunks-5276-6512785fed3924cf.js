(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5276],{42450:function(e,t,r){"use strict";r.d(t,{N:function(){return f}});var n=r(12741),a=r(20406),o=r(96412),i=r(13089),s=r(95235),u=r(28526),c=r.n(u),p=r(24553),l=r(14114);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach(function(t){(0,s.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var f=function(){var e,t;function r(e,t,n){(0,o.Z)(this,r),(0,s.Z)(this,"key",void 0),(0,s.Z)(this,"systemPrompt",void 0),(0,s.Z)(this,"systemPromptOperation",void 0),(0,s.Z)(this,"userPrompt",void 0),(0,s.Z)(this,"userPromptOperation",void 0),(0,s.Z)(this,"description",void 0),(0,s.Z)(this,"variableNames",void 0),(0,s.Z)(this,"pipes",[]),(0,s.Z)(this,"options",void 0),(0,s.Z)(this,"params",void 0),this.key=e.key,this.systemPrompt=e.systemPrompt,this.systemPromptOperation=e.systemPromptOperation,this.userPrompt=e.userPrompt,this.userPromptOperation=e.userPromptOperation,this.params=e.params||{},this.description=n.description,this.variableNames=t,this.pipes=n.pipes||[],this.options=n}return(0,i.Z)(r,[{key:"pipe",value:(e=(0,a.Z)(c().mark(function e(t,r){var a,o;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=(0,n.Z)(this.pipes);case 1:if(!a.length){e.next=10;break}if(o=a.shift()){e.next=5;break}return e.abrupt("continue",1);case 5:return e.next=7,o.apply(this,[t,r]);case 7:t=e.sent,e.next=1;break;case 10:return e.abrupt("return",t);case 11:case"end":return e.stop()}},e,this)})),function(t,r){return e.apply(this,arguments)})},{key:"run",value:(t=(0,a.Z)(c().mark(function e(t){var r,n,a,o,i,s,u,p,m,f;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.variables,a=t.history,o=t.interactionId,i=t.options,s=t.params,u=this.getMessages(n,a),e.next=4,(0,l._j)(u,d(d({},this.params),s),o,i);case 4:if(console.debug("[AI][Prompt][run] response",m=null==(p=e.sent)?void 0:null===(r=p.chatCompletion)||void 0===r?void 0:r[0].content),m){e.next=9;break}throw Error("Missing chat completion response from AI");case 9:return e.next=11,this.pipe(m,n);case 11:return f=e.sent,e.abrupt("return",f);case 13:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"getMessages",value:function(e,t){var r=d({role:p.XaP.System},this.systemPromptOperation?{operation:this.systemPromptOperation,variables:e}:{content:this.format("system",e)}),a=d({role:p.XaP.User},this.userPromptOperation?{operation:this.userPromptOperation,variables:e}:{content:this.format("user",e)});return console.debug("[AI][Prompt][run] request",r,a),[r].concat((0,n.Z)(t||[]),[a])}},{key:"format",value:function(e,t){return function(e,t){var r=e;for(var n in t)r=r.replaceAll("{{".concat(n,"}}"),t[n]);return r}("system"===e?this.systemPrompt:this.userPrompt,t)}},{key:"toJson",value:function(){return{systemPrompt:this.systemPrompt,userPrompt:this.userPrompt,variableNames:this.variableNames}}}]),r}()},76544:function(e,t,r){"use strict";r.d(t,{C6:function(){return C},rD:function(){return S}});var n,a,o,i,s=r(12741),u=r(95235),c=r(20406),p=r(28526),l=r.n(p),m=r(69262),d=r(30475),f=r(25778),b=r(43433),h=r(58609),g=r(64501),y=r(49333),v=r(20261),P=r(52333),k=r(42949);function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach(function(t){(0,u.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function w(e){function t(e){if(Object(e)!==e)return Promise.reject(TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return(w=function(e){this.s=e,this.n=e.next}).prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new w(e)}var E=new Map,I=new Map,j={},S=function(){for(var e in j)delete j[e]},A=function(e){var t=b.sC[e]?e:"google",r=m.VH.get("aiWizardBingImages"),n=m.VH.get("aiWizardGoogleImages"),a=m.VH.get("aiWizardWebImages"),o=m.VH.get("aiWizardUnsplashImages"),i=m.VH.get("aiGeneratedImages"),s=o&&"unsplash"===t?t:r&&"google"===t?"bing":n&&"google"===t?t:i&&"aiGenerated"===t?t:"bing";return a&&["bing","google"].includes(s)?"web":s},Z=(n=(0,c.Z)(l().mark(function e(t,r,n){var a,o,i,s,u,c,p;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("aiGenerated"!==r){e.next=6;break}if(a=(0,v.n_)()){e.next=4;break}throw Error("Cannot generate image without workspaceId");case 4:return o=t[0],e.abrupt("return",(0,f.Q)({prompt:o,count:1,workspaceId:a}).then(function(e){return e.map(function(e){return{query:o,image:e,provider:r}})}));case 6:if(i="".concat(r,"___").concat(t.join(",")),!E.has(i)){e.next=9;break}return e.abrupt("return",E.get(i)||[]);case 9:if(!I.has(i)){e.next=16;break}return e.next=12,I.get(i);case 12:if(e.t0=e.sent,e.t0){e.next=15;break}e.t0=[];case 15:return e.abrupt("return",e.t0);case 16:return s="bing"===r?{}:{minHeight:1e3},u="bing"===r?h.x.count:5,c=(0,b.JA)({queries:t,count:u,provider:r,prefetch:!1,options:x({minWidth:h.x.minWidth,maxWidth:h.x.maxWidth,license:n.imageLicense,gammaFeature:"aiWizard"},s)}),I.set(i,c),e.next=22,c;case 22:return p=e.sent,E.set(i,p),e.abrupt("return",p);case 25:case"end":return e.stop()}},e)})),function(e,t,r){return n.apply(this,arguments)}),C=(a=(0,c.Z)(l().mark(function e(t,r){return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all((0,s.Z)((0,y.Fr)(t,"img[searches]").map(function(e){return D(e,r)})));case 2:(0,y.Fr)(t,"images").forEach(G);case 3:case"end":return e.stop()}},e)})),function(e,t){return a.apply(this,arguments)}),N=function(e){j[e.id||e.imageUrl]=!0},G=function(e){(0,y.Fr)(e,"div > img:first-child").forEach(function(e){var t=e.parentElement;if(t){var r=JSON.parse(e.getAttribute(k.Lm)||"{}");t.setAttribute("data-image",JSON.stringify(r)),e.remove()}})},U=(o=(0,c.Z)(l().mark(function e(t){var r,n,a,o,i,s,u,c;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=null,n=!1,a=!1,e.prev=3,i=function(e){var t,r,n,a=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);a--;){if(r&&null!=(t=e[r]))return t.call(e);if(n&&null!=(t=e[n]))return new w(t.call(e));r="@@asyncIterator",n="@@iterator"}throw TypeError("Object is not async iterable")}(t);case 5:return e.next=7,i.next();case 7:var p;if(!(n=!(s=e.sent).done)){e.next=23;break}if(!(j[(p=c=(u=s.value).image).id||p.imageUrl]||!(0,P.VE)(c.imageUrl))){e.next=12;break}return e.abrupt("continue",20);case 12:return e.next=14,(0,P.KI)(c.imageUrl);case 14:if(e.sent){e.next=18;break}return N(c),console.error("Got un-downloadable image url from provider=".concat(u.provider," with query=").concat(u.query),u.image),e.abrupt("continue",20);case 18:return r=u,e.abrupt("break",23);case 20:n=!1,e.next=5;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(3),a=!0,o=e.t0;case 29:if(e.prev=29,e.prev=30,!(n&&null!=i.return)){e.next=34;break}return e.next=34,i.return();case 34:if(e.prev=34,!a){e.next=37;break}throw o;case 37:return e.finish(34);case 38:return e.finish(29);case 39:return e.abrupt("return",r);case 40:case"end":return e.stop()}},e,null,[[3,25,29,39],[30,,34,38]])})),function(e){return o.apply(this,arguments)}),D=(i=(0,c.Z)(l().mark(function e(t,r){var n,a,o,i,s,u,c,p,f,h,y,P,O;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.getAttribute("bookmark")){e.next=2;break}return e.abrupt("return");case 2:var l,w;return l=a=A(m.VH.get("aiGeneratedImagesInWizard")?"aiGenerated":(null===(n=t.getAttribute("provider"))||void 0===n?void 0:n.toLowerCase())||""),o=(w=t.getAttribute("searches"))?"bing"===l?[w.split(", ")[0]]:w.split(", "):[],e.next=8,Z(o,a,r);case 8:return i=e.sent,e.next=11,U(i);case 11:if(s=e.sent){e.next=15;break}return t.setAttribute("placeholder","true"),e.abrupt("return");case 15:if(u=s.query,c=s.image,p=b.sC[a],f=r.uploadImages&&["google","bing","web"].includes(a),N(c),!f){e.next=32;break}return e.prev=20,e.next=23,Promise.race([new Promise(function(e,t){(0,d.uploadFileFromUrl)(c.imageUrl,(0,v.n_)(),{onOriginalFileUpload:function(t){console.debug("uploadResult",{uploadResult:t}),e(t)},onUploadFailed:function(e){console.debug("onUploadFailed",{err:e}),t(e)}})}),new Promise(function(e,t){setTimeout(function(){return t(Error("Image upload timed out"))},15e3)})]);case 23:return y={src:(h=e.sent).src,tempUrl:h.src,meta:h.meta,query:u,source:p.key},t.setAttribute(k.Lm,JSON.stringify(y)),e.abrupt("return");case 29:e.prev=29,e.t0=e.catch(20),console.warn("Failed to upload image",{err:e.t0});case 32:P="aiGenerated"===a?d.UploadStatus.Done:d.UploadStatus.Queued,O=x(x({},(0,g.C)(c,u,a)),{},{uploadStatus:P}),t.setAttribute(k.Lm,JSON.stringify(O));case 35:case"end":return e.stop()}},e,null,[[20,29]])})),function(e,t){return i.apply(this,arguments)})},7008:function(e,t,r){"use strict";r.d(t,{T:function(){return u}});var n,a=r(20406),o=r(28526),i=r.n(o),s=r(76544),u=(n=(0,a.Z)(i().mark(function e(t){var r,n,a=arguments;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:{},e.prev=1,n=new DOMParser().parseFromString(t,"text/html"),r.removeImagesFromLayouts&&c(n),e.next=6,(0,s.C6)(n,r);case 6:return!1!==r.resetImageSearches&&(0,s.rD)(),e.abrupt("return",n.body.innerHTML);case 10:return e.prev=10,e.t0=e.catch(1),console.error("Error transforming AI HTML",e.t0),e.abrupt("return",t);case 14:case"end":return e.stop()}},e,null,[[1,10]])})),function(e){return n.apply(this,arguments)}),c=function(e){e.querySelectorAll(":is(boxes, timeline, table, columns, bullets) img").forEach(function(e){e.remove()})}},34275:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(42450),a=r(24553),o=new n.N({key:"GENERATE_PRESENTATION_ADVANCED",params:{temperature:1,model:"gpt-3.5-turbo"},systemPrompt:"".trim(),systemPromptOperation:a.Run.GeneratePresentationAdvancedSystem,userPrompt:"".trim(),userPromptOperation:a.Run.GeneratePresentationAdvancedUser},["instructions","input","numCards"],{}),i={label:"presentation",key:"presentation",docFormat:"deck",buttonBGColor:"#CCA5DA",smallButtonBGColor:"#84389E",bgImageUrl:"https://cdn.gamma.app/zc87vhr30n8uf3n/29a73f2a0f5840d4a9d30b150a8b0c22/optimized/slide-bg.svg",generatePrompt:new n.N({key:"GENERATE_PRESENTATION",params:{temperature:1},systemPrompt:"",systemPromptOperation:a.Run.GeneratePresentationSystem,userPrompt:"",userPromptOperation:a.Run.GeneratePresentationUser},["input","numCards","language"],{}),generatePromptAdvanced:o,description:"Present live or share async for reading. Cards expand to fit your content."}},38737:function(e,t,r){"use strict";r.d(t,{S:function(){return f}});var n=r(12741),a=r(2284),o=r.n(a),i=r(1313),s=r.n(i),u=r(79898),c=r(67041),p=["gridLayout","table","gallery"],l=["timeline","imagesText","textBoxes"],m=function(e){return s()(e)()},d=function(e,t){var r=Math.floor(s()(t)()*e.length);return e[r]},f=function(e){var t,r,a,i,s=e.bodyContent,f=e.theme,b=e.format,h=e.index,g=e.seed,y=e.cardId,v=e.accentBackground,P=e.layout,k=e.cardSize,O=e.addContributorsBlock,x=(null==s?void 0:s.filter(function(e){var t;return"image"===e.type&&(null===(t=e.attrs)||void 0===t?void 0:t.src)}))||[],w=null==s?void 0:s.some(function(e){return p.includes(e.type)||"smartLayout"===e.type&&e.attrs&&l.includes(e.attrs.variantKey)}),E={container:{},layout:P,id:y};k&&(E.cardSize=k),v||(s&&x.length>0?(v={type:u.Eo.IMAGE,image:x[0].attrs,source:x[0].attrs.source},o().apply(void 0,[s].concat((0,n.Z)(x)))):!v&&f&&(v=d(f.config.accentBackgrounds||[],g))),"webpage"!==b.key||P||(0===h?(E.cardSize="full",E.layout=d(["behind","right"],g)):.7>m(g)?(E.cardSize="full",E.layout=w?"blank":d(["left","right","behind","blank"],g)):(E.cardSize="default",.6>m(g)&&(E.background=v),E.layout="blank")),"presentation"!==b.key||P||(0!==h||w?w?E.layout="blank":E.layout=d(["left","left","right","right","behind","top"],g):E.layout=d(["left","right"],g)),"document"!==b.key||P||(0===h?(E.cardSize="full",E.layout="behind"):E.layout="blank"),(void 0===O||O)&&0===h&&"webpage"!==b.key&&(null==s||s.push({type:"contributors"}));var I={type:"cardLayoutItem",attrs:{itemId:"body"},content:null!=s&&s.length?s:[{type:"paragraph"}]},j="blank"===E.layout?null:{type:"cardAccentLayoutItem",attrs:{itemId:"accent",background:v}},S=null===(t=v)||void 0===t?void 0:null===(r=t.image)||void 0===r?void 0:null===(a=r.meta)||void 0===a?void 0:a.average_color,A=S&&(0,c.DP)(S);return"behind"===E.layout&&(A||.5>m(g))&&(null!==(i=E.container)&&void 0!==i||(E.container={}),E.container.background={type:u.Eo.COLOR,color:{hex:"#000000"}}),{type:"card",attrs:E,content:[I,j].filter(Boolean)}}},80660:function(){}}]);
//# sourceMappingURL=5276-6512785fed3924cf.js.map